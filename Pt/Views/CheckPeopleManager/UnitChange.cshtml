@model Pkpm.Entity.Models.PeopleUnitChangeModel
@{
    ViewBag.Title = "UnitChange";
    Layout = "~/Views/Shared/LayuiTab_Layout.cshtml";
}
@Model.PeopleName

<div class="layui-container">
    <div class="layui-row" id="CheckPeopleManager-UnitChange-Container">
        <form class="layui-form" action="" lay-filter="CheckPeopleManager-UnitChange-form">
            <div class="layui-form-item">
                <label id="peopleName">将人员移动到：</label>
            </div>
            <div class="layui-form-item">
                <select name="Customid" lay-verify="required" lay-search="">
                    <option value="">请选择</option>
                    @{
                        foreach (var item in Model.AllUnit)
                        {
                            <option value="@item.Key">@item.Value</option>
                        }
                    }
                </select>
            </div>
            <div>
                <button class="layui-btn" lay-submit lay-filter="checkPeopleManager-UnitChange-save">保存</button>
            </div>
        </form>
    </div>
</div>
<script>
    layui.use(["form", "element", "layer"], function () {
        var $ = layui.$,
            form = layui.form,
            layer = layui.layer,
            element = layui.element,
            router = layui.router();
        form.on('submit(checkPeopleManager-UnitChange-save)', function (data) {
            var dataField = data.field;
            dataField["peopleId"] = '@Model.PeopleId';
            $.ajax({
                type: "POST",
                dataType: "json",
                data: dataField,
                url: "/CheckPeopleManager/unitChange",
                success: function (d) {
                    if (d.IsSucc) {
                        layer.msg('变更单位成功', {
                            time: 0,
                            btn: ['确定'],
                            yes: function (index) {
                                layer.close(index);
                                parent.layer.closeAll();
                                parent.mygrid.clearAll();
                                gridQString = '/CheckPeopleManager/Search?' + parent.getQueryStr();
                                parent.mygrid.load(gridQString);
                            },
                            icon: 1
                        });
                    } else {
                        layer.msg('变更单位失败，错误信息：' + d.ErroMsg, {
                            icon: 2
                        });
                    }
                }
            })
            return false;
        })
    });
</script>
